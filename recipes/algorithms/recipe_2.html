<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <style type="text/css"> .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(3) > .nav-list > .nav-list-item:nth-child(2) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); } .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list > .nav-list-item:not(.passive):nth-child(2) > .nav-list-expander svg { transform: rotate(-90deg); } .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(3) > .nav-list > .nav-list-item:not(.passive):nth-child(2) > .nav-list { display: block; } .site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); } .site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Learning with Costs | Rinse and Repeat Data Science</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Learning with Costs" /> <meta name="author" content="Rajiv Sambasivan" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat." /> <meta property="og:description" content="Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat." /> <meta property="og:site_name" content="Rinse and Repeat Data Science" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Learning with Costs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Rajiv Sambasivan"},"description":"Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat.","headline":"Learning with Costs","url":"/recipes/algorithms/recipe_2.html"}</script> <!-- End Jekyll SEO tag --> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Learning with Costs | Rinse and Repeat Data Science</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Learning with Costs" /> <meta name="author" content="Rajiv Sambasivan" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat." /> <meta property="og:description" content="Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat." /> <meta property="og:site_name" content="Rinse and Repeat Data Science" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Learning with Costs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Rajiv Sambasivan"},"description":"Framing your usecase in terms of known problem patterns is a task that requires deep technical skills, practioner experience and engineering judgement. A seasoned data scientist can help you get your vision to fruition. The first version of the solution is what is typically difficult. Subsequently, it is usually rinse and repeat.","headline":"Learning with Costs","url":"/recipes/algorithms/recipe_2.html"}</script> <!-- End Jekyll SEO tag --> <!-- Google Analytics tracking ID --> <!-- Copied from https://katex.org/docs/browser.html#starter-template --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/" crossorigin="anonymous"> <!-- The loading of KaTeX is deferred to speed up page rendering --> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js" integrity="sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O" crossorigin="anonymous"> </script> <!-- Automatically display code inside script tags with type=math/tex using KaTeX --> <script defer src="/assets/js/mathtex-script-type.js"> </script> <!-- To automatically render math in text elements, include the auto-render extension: --> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body, { globalGroup: true, trust: true, strict: false, throwOnError: false, });"></script> <!-- The KaTeX default is 1.21em, see https://katex.org/docs/font.html#font-size-and-lengths --> <style> .katex { font-size: 1em; } </style> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Rinse and Repeat Data Science </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/about/" class="nav-list-link">Services Provided</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Analytic Recipes category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/recipes/analytics/" class="nav-list-link">Analytic Recipes</a><ul class="nav-list"><li class="nav-list-item"><a href="/recipes/analytics/recipe_2.html" class="nav-list-link">Action Cost</a></li><li class="nav-list-item"><a href="/recipes/analytics/recipe_3.html" class="nav-list-link">Entity Demand/Load</a></li><li class="nav-list-item"><a href="/recipes/analytics/recipe_1.html" class="nav-list-link">Event Duration</a></li><li class="nav-list-item"><a href="/recipes/analytics/recipe_4.html" class="nav-list-link">Frequent Items (Big Data)</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Algorithms category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/recipes/algorithms/" class="nav-list-link">Algorithms</a><ul class="nav-list"><li class="nav-list-item"><a href="/recipes/algorithms/recipe_1.html" class="nav-list-link">BiClustering</a></li><li class="nav-list-item"><a href="/recipes/algorithms/recipe_2.html" class="nav-list-link">Learning with Costs</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Development category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/development/" class="nav-list-link">Development</a><ul class="nav-list"><li class="nav-list-item"><a href="/development/recipe_1.html" class="nav-list-link">Tools and Utilities</a></li></ul></li><li class="nav-list-item"><a href="/interests/" class="nav-list-link">Focus Areas</a></li><li class="nav-list-item"><a href="/process/" class="nav-list-link">The Process</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Rinse and Repeat Data Science" aria-label="Search Rinse and Repeat Data Science" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/recipes/algorithms/">Algorithms</a></li> <li class="breadcrumb-nav-list-item"><span>Learning with Costs</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 id="description"> <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p style="text-align: justify">Business or organizational actions taken on the basis of a prediction from a machine learning model have business or organizational consequences. For example, in a Banking application, rejecting a loan applicant who turns out to be credit worthy results in lost revenue to the Bank. Approving a loan to a defaulter, could result in a bigger loss. Excessive security redirections in a business website could be a detractor to potential customers. Lax security measures could result in legal charges and financial losses. Making decisions based on costa associated with actions is a critical need. <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a> provides an excellent discussion of the basic concepts used in developing the theory around cost based decision making in machine learning applications. <a class="citation" href="#ling2008cost">(Ling &amp; Sheng, 2008)</a> is a more recent (still over ten years old as of this writing) treatment that surveys approaches to cost based decision making. A key characteristic of making decisions where cost is relevant using supervised learning is that such applications are usually associated with <em>imbalanced</em> datasets. Some classes of the target variable are <em>under-represented</em> in the dataset. To make this idea concrete, consider the binary classification setting. There are two classes, one of which is <em>under-represented</em>. This is called the <em>minority class</em>. By contrast, the <em>over-represented</em> class is called the <em>majority class</em>. This discussion follows the convention used in <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a>. The <em>minority class</em> is associated with the \(1\) label and the <em>majority class</em> is associated with the \(0\) label. In a balanced dataset, the prior probablity of the \(0\) and the \(1\) class is \(0.5\). A key idea used in solving the imbalance issue is to construct a balanced data set out of the original imbalanced dataset using sampling. <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a> develops a theory that explains how we can create a balanced dataset out of an imbalanced dataset on the basis of costs associated with classifying an example with a particular target value (\(0\) or \(1\)). <a class="citation" href="#hart1968condensed">(Hart, 1968)</a> uses an idea based on developing a balanced dataset from the imbalanced data set by preserving the neighborhood of each minority class instance to be consistent with the neighborhood of the point in imbalanced raw dataset. See <a href="https://www.youtube.com/watch?v=XRbb3IbUYK8&amp;list=PLV7MgHu4-vg27CxbsIGu_1x6nN0PQL7_N&amp;index=63">this video link</a> for more details on the idea. This principle is used developing the solution. This choice was made because <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a> provides the rationale to undersample the minority class but does not prescribe <em>how</em> to achieve it (fair enough). Random undersampling of the majority class can change the decision boundary that manifests in the original imbalanced dataset. Condensed nearest neighbors is attractive because it <em>preserves the decision boundary</em> associated with problem. It should be noted that the probabilities predicated by the model developed on the data may still be noisy. Probability caliberation can be applied to correct noise. This will be addressed in a separate algorithmic recipe shortly.</p> <h2 id="algorithm-input-data-description"> <a href="#algorithm-input-data-description" class="anchor-heading" aria-labelledby="algorithm-input-data-description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Algorithm Input Data Description </h2> <p style="text-align: justify">Costs associated with model decisions are inputs that are needed to apply this algorithm. These costs are developed based on Action Costs recipe. See <a href="https://github.com/rajivsam/learning_with_costs/blob/main/notebooks/preliminary_exploration_2010_7a_data.ipynb">this notebook</a> for how false positive and false negative costs are estimated in a loan quality setting. The reduction of the imbalanced dataset to a balanced dataset using the techniques discussed in <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a> and <a class="citation" href="#hart1968condensed">(Hart, 1968)</a> are illustrated in <a href="https://github.com/rajivsam/learning_with_costs/blob/main/notebooks/model_selection.ipynb">this notebook</a></p> <h2 id="algorithm-solution-description"> <a href="#algorithm-solution-description" class="anchor-heading" aria-labelledby="algorithm-solution-description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Algorithm Solution Description </h2> <p style="text-align: justify">Feature engineering can be very useful in datasets with class imbalance. This turned out to be the case for the example used to illustrate the learning with costs algorithm. The example uses real world data published by the Small Business Adminsitration (SBA). It provides details about the loan repayment history for businesses it assists. Loan defaults and cancellations do occur, though most loans are paid in full. Predicting loan defaults is an established application in the finance domain. Location is important in real estate. It turned out to be pivot for feature engineering done with this dataset. Exploratory data analysis revealed that defaults occur only a specific set of zip codes. By creating a derived attribute that captures if a zip code associated with a loan falls witin this “bad” set of zip codes, we can compute a very effective loan quality model. Using just the raw features can lead you to models with poor performance. This underscores the value of exploratory data analysis, feature engineering and due dilligence in developing data science solutions. The solutions using the approach by <a class="citation" href="#DBLP_conf_ijcai_Elkan01">(Elkan, 2001)</a> and <a class="citation" href="#hart1968condensed">(Hart, 1968)</a> provide similar results. The <a href="https://imbalanced-learn.org/stable/">imbalanced-learn</a> library was used for the reference implementation. In this recipe, the condensed nearest neighbor approach is used for constructing the balanced dataset, other approaches are also possible, see <a href="https://imbalanced-learn.org/stable/">imbalanced-learn</a> for more details.</p> <h2 id="bibliography"> <a href="#bibliography" class="anchor-heading" aria-labelledby="bibliography"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bibliography </h2> <ol class="bibliography"><li><span id="DBLP_conf_ijcai_Elkan01">Elkan, C. (2001). The Foundations of Cost-Sensitive Learning. In B. Nebel (Ed.), <i>Proceedings of the Seventeenth International Joint Conference on Artificial Intelligence, IJCAI 2001, Seattle, Washington, USA, August 4-10, 2001</i> (pp. 973–978). Morgan Kaufmann.</span></li> <li><span id="ling2008cost">Ling, C. X., &amp; Sheng, V. S. (2008). Cost-sensitive learning and the class imbalance problem. <i>Encyclopedia of Machine Learning</i>, <i>2011</i>, 231–235.</span></li> <li><span id="hart1968condensed">Hart, P. (1968). The condensed nearest neighbor rule (corresp.). <i>IEEE Transactions on Information Theory</i>, <i>14</i>(3), 515–516.</span></li></ol> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
